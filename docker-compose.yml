version: '3'

services:
  python_netapp:
    image: python_netapp
    networks:
      - demo-network
    hostname: dummy
    container_name: python_netapp
    build:
      context: ./pythonnetapp
    volumes:
      - ./pythonnetapp:/usr/src/app
    environment:
      - REDIS_HOST=redis
      - REDIS_PORT=6379
      - REQUESTS_CA_BUNDLE=/usr/src/app/ca.crt
      - SSL_CERT_FILE=/usr/src/app/ca.crt
      - CAPIF_HOSTNAME=${CAPIF_HOSTNAME}
      - CAPIF_PORT=8080
    extra_hosts:
      - host.docker.internal:host-gateway
  # capif_callback_server:
  #   build:
  #     context: ./capif_callback_server
  #   ports:
  #     - 8086:8080
  #   volumes:
  #     - ./capif_callback_server:/usr/src/app
  #   environment:
  #     - REDIS_HOST=redis
  #     - REDIS_PORT=6379
  #   extra_hosts:
  #     - host.docker.internal:host-gateway

networks:
  demo-network:
    external: true
